<ResourceDictionary
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:converters="clr-namespace:HLU.Converters">

    <!--  Error Message Converter - Extracts prefix before colon  -->
    <converters:ErrorMessageConverter x:Key="errorMessageConverter" />

    <!--  ErrorTemplate - Red circle with exclamation mark  -->
    <ControlTemplate x:Key="ErrorTemplate">
        <DockPanel>
            <Grid DockPanel.Dock="Right">
                <Ellipse
                    Width="14"
                    Height="14"
                    VerticalAlignment="Center"
                    Fill="Red"
                    Stroke="Black"
                    StrokeThickness="0.5" />
                <TextBlock
                    Margin="0"
                    Padding="5,0,0,0"
                    VerticalAlignment="Center"
                    FontWeight="Bold"
                    Foreground="White"
                    Text="!"
                    ToolTip="{Binding RelativeSource={RelativeSource Self}, Path=(Validation.Errors).CurrentItem.ErrorContent}" />
            </Grid>
            <Border BorderBrush="Red" BorderThickness="1">
                <AdornedElementPlaceholder />
            </Border>
        </DockPanel>
    </ControlTemplate>

    <!--  WarningTemplate - Orange triangle with exclamation mark  -->
    <ControlTemplate x:Key="WarningTemplate">
        <DockPanel>
            <Grid DockPanel.Dock="Right">
                <Polygon
                    VerticalAlignment="Center"
                    Fill="Orange"
                    Points="0,17 14,17, 7,1"
                    Stroke="Black"
                    StrokeThickness="0.5" />
                <TextBlock
                    Margin="0"
                    Padding="5,4,0,0"
                    VerticalAlignment="Center"
                    FontWeight="Bold"
                    Foreground="White"
                    Text="!"
                    ToolTip="{Binding RelativeSource={RelativeSource Self}, Path=(Validation.Errors).CurrentItem.ErrorContent}" />
            </Grid>
            <Border BorderBrush="Orange" BorderThickness="1">
                <AdornedElementPlaceholder />
            </Border>
        </DockPanel>
    </ControlTemplate>

    <!--  DataGrid Row Validation Template - Error (Red circle)  -->
    <ControlTemplate x:Key="DataGridRowErrorTemplate">
        <Grid
            Width="16"
            Height="16"
            Margin="2,0,0,0"
            ToolTip="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type DataGridRow}}, Path=(Validation.Errors).CurrentItem.ErrorContent}">
            <Ellipse
                Width="14"
                Height="14"
                Fill="Red"
                Stroke="Black"
                StrokeThickness="0.5" />
            <TextBlock
                Margin="0,0,0,1"
                HorizontalAlignment="Center"
                VerticalAlignment="Center"
                FontSize="10"
                FontWeight="Bold"
                Foreground="White"
                Text="!" />
        </Grid>
    </ControlTemplate>

    <!--  DataGrid Row Validation Template - Warning (Orange triangle)  -->
    <ControlTemplate x:Key="DataGridRowWarningTemplate">
        <Grid
            Width="16"
            Height="18"
            Margin="2,0,0,0"
            ToolTip="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type DataGridRow}}, Path=(Validation.Errors).CurrentItem.ErrorContent}">
            <Polygon
                Fill="Orange"
                Points="0,17 14,17, 7,1"
                Stroke="Black"
                StrokeThickness="0.5" />
            <TextBlock
                Margin="-2,4,0,0"
                HorizontalAlignment="Center"
                VerticalAlignment="Center"
                FontSize="10"
                FontWeight="Bold"
                Foreground="White"
                Text="!" />
        </Grid>
    </ControlTemplate>

    <!--  DataGrid Row Style with Validation - Shows error/warning icon in row header based on INotifyDataErrorInfo.HasErrors  -->
    <Style
        x:Key="DataGridRowWithValidation"
        BasedOn="{StaticResource Esri_DataGridRow}"
        TargetType="DataGridRow">
        <Setter Property="ValidationErrorTemplate" Value="{x:Null}" />
        <Style.Triggers>
            <!--  Trigger on HasErrors property of the data item (INotifyDataErrorInfo)  -->
            <DataTrigger Binding="{Binding HasErrors}" Value="True">
                <Setter Property="ValidationErrorTemplate" Value="{StaticResource DataGridRowErrorTemplate}" />
            </DataTrigger>
        </Style.Triggers>
    </Style>

    <!--  Global TextBox Style - Based on default, adds validation template triggers  -->
    <Style BasedOn="{StaticResource {x:Type TextBox}}" TargetType="{x:Type TextBox}">
        <Style.Triggers>
            <Trigger Property="Tag" Value="Error">
                <Setter Property="Validation.ErrorTemplate" Value="{StaticResource ErrorTemplate}" />
            </Trigger>
            <Trigger Property="Tag" Value="Warning">
                <Setter Property="Validation.ErrorTemplate" Value="{StaticResource WarningTemplate}" />
            </Trigger>
        </Style.Triggers>
    </Style>

    <!--  Global ComboBox Style - Based on default, adds validation template triggers  -->
    <Style BasedOn="{StaticResource {x:Type ComboBox}}" TargetType="{x:Type ComboBox}">
        <Style.Triggers>
            <Trigger Property="Tag" Value="Error">
                <Setter Property="Validation.ErrorTemplate" Value="{StaticResource ErrorTemplate}" />
            </Trigger>
            <Trigger Property="Tag" Value="Warning">
                <Setter Property="Validation.ErrorTemplate" Value="{StaticResource WarningTemplate}" />
            </Trigger>
        </Style.Triggers>
    </Style>

    <!--  Global Label Style - Based on default, adds validation template triggers  -->
    <Style BasedOn="{StaticResource {x:Type Label}}" TargetType="{x:Type Label}">
        <Style.Triggers>
            <Trigger Property="Tag" Value="Error">
                <Setter Property="Validation.ErrorTemplate" Value="{StaticResource ErrorTemplate}" />
            </Trigger>
            <Trigger Property="Tag" Value="Warning">
                <Setter Property="Validation.ErrorTemplate" Value="{StaticResource WarningTemplate}" />
            </Trigger>
        </Style.Triggers>
    </Style>

</ResourceDictionary>